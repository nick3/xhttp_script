# 证书管理功能说明

## 新增功能

本项目现在支持两种证书管理方式：

1. **ACME 自动申请证书**（默认，推荐）
   - 自动从 Let's Encrypt 或 ZeroSSL 等证书颁发机构申请证书
   - 自动续期，无需手动管理

2. **使用现有证书文件**
   - 允许用户使用自己的证书文件
   - 适用于已有证书或内部证书的情况

## 配置选项

在 `main.sh` 脚本中，用户现在可以选择证书类型：

- 选项 1：使用 ACME 自动申请证书（推荐）
- 选项 2：使用现有证书文件

## 参数说明

install.sh 脚本现在接受以下参数：

```bash
bash install.sh <domain> <kcp_seed> <www_root_path> [cert_type] [cert_path] [key_path] [email]
```

- `cert_type`: 证书类型 ("acme" 或 "existing")
- `cert_path`: 证书文件路径（仅适用于现有证书）
- `key_path`: 私钥文件路径（仅适用于现有证书）
- `email`: 邮箱地址（用于 ACME 证书申请）

## 配置文件生成

根据证书类型，脚本会生成不同的 Caddy 配置：

- **ACME 配置**：包含自动化证书申请配置
- **现有证书配置**：包含内联证书加载器，直接使用指定的证书文件

## 安全验证

- 对现有证书文件路径进行存在性验证
- 验证证书和私钥文件是否存在
- 保持原有的输入验证和安全检查

## 兼容性

- 保持与原有配置的向后兼容
- 默认行为仍为 ACME 自动申请证书
- 不影响现有的 Xray 配置和其他功能